<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Speed Click Obby 3D</title>
<style>
body { margin: 0; overflow: hidden; background: black; }
#ui {
    position: absolute;
    top: 10px;
    left: 10px;
    color: white;
    font-family: Arial;
    z-index: 1;
}
button {
    padding: 5px 10px;
    margin-top: 5px;
}
</style>
</head>

<body>

<div id="ui">
    <p>‚ö° Speed: <span id="speed">1</span></p>
    <p>üèÜ Victorias: <span id="wins">0</span></p>
    <button onclick="addSpeed()">CLICK SPEED</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<script>
// ESCENA
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb);

// C√ÅMARA
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0, 6, 10);

// RENDER
const renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// LUZ
scene.add(new THREE.HemisphereLight(0xffffff, 0x444444, 1));

// SUELO
const floor = new THREE.Mesh(
    new THREE.BoxGeometry(50, 1, 50),
    new THREE.MeshStandardMaterial({ color: 0x00ff00 })
);
floor.position.y = -1;
scene.add(floor);

// PERSONAJE (ESTILO ROBLOX)
const player = new THREE.Group();

// CUERPO (SKIN)
const skinColor = 0xffcc99;
const bodyMat = new THREE.MeshStandardMaterial({ color: skinColor });

const torso = new THREE.Mesh(new THREE.BoxGeometry(1.5, 2, 1), bodyMat);
torso.position.y = 2;
player.add(torso);

const head = new THREE.Mesh(new THREE.BoxGeometry(1.2, 1.2, 1.2), bodyMat);
head.position.y = 3.6;
player.add(head);

scene.add(player);

// OBBY
const platforms = [];
for (let i = 0; i < 10; i++) {
    const plat = new THREE.Mesh(
        new THREE.BoxGeometry(3, 0.5, 3),
        new THREE.MeshStandardMaterial({ color: 0xff0000 })
    );
    plat.position.set(0, i * 2, -i * 6);
    scene.add(plat);
    platforms.push(plat);
}

// META
const goal = new THREE.Mesh(
    new THREE.BoxGeometry(4, 1, 4),
    new THREE.MeshStandardMaterial({ color: 0xffff00 })
);
goal.position.set(0, 20, -60);
scene.add(goal);

// VARIABLES
let speed = 0.1;
let wins = 0;
let velocityY = 0;
let onGround = false;

// CONTROLES
document.addEventListener("keydown", e => {
    if (e.code === "Space" && onGround) {
        velocityY = 0.35;
        onGround = false;
    }
});

// SPEED PER CLICK
function addSpeed() {
    speed += 0.05;
    document.getElementById("speed").innerText = speed.toFixed(2);
}

// COLISIONES
function checkCollision(obj) {
    const box1 = new THREE.Box3().setFromObject(player);
    const box2 = new THREE.Box3().setFromObject(obj);
    return box1.intersectsBox(box2);
}

// LOOP
function animate() {
    requestAnimationFrame(animate);

    // Movimiento adelante
    player.position.z -= speed;

    // Gravedad
    velocityY -= 0.02;
    player.position.y += velocityY;

    onGround = false;

    platforms.forEach(p => {
        if (checkCollision(p) && velocityY <= 0) {
            player.position.y = p.position.y + 1.2;
            velocityY = 0;
            onGround = true;
        }
    });

    // Suelo
    if (player.position.y < 0) {
        player.position.y = 0;
        velocityY = 0;
        onGround = true;
    }

    // Victoria
    if (checkCollision(goal)) {
        wins++;
        document.getElementById("wins").innerText = wins;
        alert("üèÜ ¬°Victoria!");
        player.position.set(0, 0, 0);
        speed = 0.1;
    }

    camera.position.z = player.position.z + 10;
    camera.position.y = player.position.y + 6;
    camera.lookAt(player.position);

    renderer.render(scene, camera);
}

animate();
</script>

</body>
</html>
