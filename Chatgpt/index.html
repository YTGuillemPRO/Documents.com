<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IA Híbrida con Internet</title>
  <style>
    :root {
      --bg: #0b0e14;
      --card: #151921;
      --text: #ffffff;
      --accent: #00d2ff;
      --user: #242933;
      --ai: #1c212c;
    }

    body { 
      font-family: 'Segoe UI', sans-serif; 
      background: var(--bg); color: var(--text);
      margin: 0; display: flex; flex-direction: column; height: 100vh; 
    }

    header { padding: 15px; background: var(--card); text-align: center; border-bottom: 2px solid var(--accent); font-weight: bold; letter-spacing: 2px; }

    #chat { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; }

    .msg { max-width: 85%; padding: 15px; border-radius: 12px; line-height: 1.5; font-size: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
    .user { align-self: flex-end; background: var(--user); border-bottom-right-radius: 2px; border: 1px solid #3b4252; }
    .ai { align-self: flex-start; background: var(--ai); border-bottom-left-radius: 2px; border-left: 4px solid var(--accent); }

    .status { font-size: 0.8rem; color: var(--accent); margin-bottom: 5px; font-style: italic; }

    #input-container { display: flex; padding: 20px; background: var(--card); gap: 10px; }
    #input { flex: 1; padding: 15px; border-radius: 8px; border: 1px solid #3b4252; background: #0b0e14; color: white; outline: none; }
    #btn-send { padding: 0 25px; border: none; border-radius: 8px; background: var(--accent); color: black; font-weight: bold; cursor: pointer; transition: 0.3s; }
    #btn-send:hover { transform: scale(1.05); }
  </style>
</head>
<body>

  <header>AI WEB INVESTIGATOR</header>
  <div id="chat"></div>

  <div id="input-container">
    <input type="text" id="input" placeholder="Pregúntame algo que deba buscar en la web..." autocomplete="off">
    <button id="btn-send">Enviar</button>
  </div>

  <script>
    const chatBox = document.getElementById("chat");
    const inputField = document.getElementById("input");

    /* ================= FUNCIÓN DE BÚSQUEDA WEB (WIKIPEDIA) ================= */
    async function investigarWeb(tema) {
      const url = `https://es.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(tema)}`;
      try {
        const response = await fetch(url);
        const data = await response.json();
        if (data.extract) {
          return data.extract;
        } else {
          return "No encontré información específica, pero puedo seguir aprendiendo si me lo explicas.";
        }
      } catch (error) {
        return "Hubo un error al intentar conectarme a la red. ¿Tienes internet?";
      }
    }

    /* ================= LÓGICA DE RESPUESTA ================= */
    async function pensar(texto) {
      const t = texto.toLowerCase();

      // 1. Detectar intención de búsqueda (Quién es, Qué es, etc.)
      if (t.includes("quien es") || t.includes("que es") || t.includes("quien fue") || t.includes("investiga") || t.includes("presidente")) {
        let busqueda = t.replace(/quien es|que es|quien fue|investiga sobre|cuentame de|el |la /g, "").trim();
        
        // Caso específico Presidente USA (para que sea más preciso)
        if(t.includes("presidente") && t.includes("estados unidos")) busqueda = "Presidente de los Estados Unidos";

        addMsg("IA", "Investigando en la web...", "ai", true);
        const resultado = await investigarWeb(busqueda);
        
        // Eliminar el mensaje de "Investigando..."
        const loadingMsg = document.querySelector('.status');
        if(loadingMsg) loadingMsg.parentElement.remove();

        return resultado;
      }

      // 2. Respuestas locales sencillas (con tolerancia a fallos)
      if (t.includes("hola") || t.includes("buenos dias")) return "¡Hola! Estoy listo para investigar lo que necesites.";
      if (t.includes("gracias")) return "¡De nada! ¿Quieres saber algo más sobre historia o actualidad?";
      
      // 3. Matemáticas rápidas
      try {
        let op = t.replace(/x/g, "*").replace(/[^0-9+\-*/(). ]/g, "");
        if (op.length >= 3) return "El resultado es: " + eval(op);
      } catch(e) {}

      return "Para ayudarte mejor, prueba a preguntarme '¿Quién es...?' o '¿Qué es...?' y buscaré en mis archivos web.";
    }

    /* ================= INTERFAZ ================= */
    function addMsg(quien, texto, clase, esLoading = false) {
      const d = document.createElement("div");
      d.className = `msg ${clase}`;
      if(esLoading) d.innerHTML = `<div class="status">Buscando...</div>`;
      else d.innerHTML = `<b>${quien}</b><br>${texto}`;
      chatBox.appendChild(d);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    async function enviar() {
      const txt = inputField.value.trim();
      if (!txt) return;

      addMsg("Tú", txt, "user");
      inputField.value = "";

      const respuesta = await pensar(txt);
      addMsg("IA", respuesta, "ai");
    }

    document.getElementById("btn-send").onclick = enviar;
    inputField.onkeydown = (e) => { if(e.key === "Enter") enviar(); };

    addMsg("IA", "Sistema Híbrido Activo. Pregúntame sobre cualquier personaje histórico, país o el presidente de cualquier lugar.", "ai");
  </script>
</body>
</html>
