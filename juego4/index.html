<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Nova League 3D - Elite Edition âš½</title>
<style>
body{margin:0;overflow:hidden;font-family:'Segoe UI', sans-serif;background:#000;}
#menu, #overlay{
  position:absolute;inset:0;
  background:radial-gradient(circle, #1b2735 0%, #090a0f 100%);
  display:flex;flex-direction:column;justify-content:center;align-items:center;
  color:white;text-align:center;z-index:100;
}
#ui-container{position:absolute;top:20px;width:100%;display:flex;justify-content:center;gap:50px;pointer-events:none;z-index:10;}
.hud-box{background:rgba(0,0,0,0.7);padding:10px 30px;border-radius:10px;border-bottom:4px solid #00d4ff;color:white;font-size:2em;font-weight:900;}
#goalMsg{position:absolute;top:40%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:7em;font-weight:900;text-shadow:0 0 40px #ff0000;z-index:20;display:none;font-style:italic;}
.btn{background:linear-gradient(45deg,#00d4ff,#0055ff);border:none;padding:15px 50px;font-size:1.3em;border-radius:5px;cursor:pointer;color:white;font-weight:bold;text-transform:uppercase;transition:0.2s;margin:10px;box-shadow:0 5px 15px rgba(0,85,255,0.4);}
.btn:hover{transform:translateY(-3px);}
h1{font-size:5em;margin:0;background:linear-gradient(#fff,#888);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
#game{display:none;}
</style>
</head>
<body>

<div id="menu">
<h1>NOVA LEAGUE PRO</h1>
<p style="color:#00d4ff">ELITE SOCCER SIMULATOR - 11 VS 11</p>
<button class="btn" onclick="startGame(0.12)">AMATEUR</button>
<button class="btn" onclick="startGame(0.18)">PROFESIONAL</button>
<button class="btn" onclick="startGame(0.25)">LEYENDA</button>
<p>WASD / FLECHAS Â· E Chutar Â· Q Pase Â· F Robar</p>
</div>

<div id="overlay" style="display:none;">
<h1 id="overlayTitle"></h1>
<button class="btn" id="overlayBtn" onclick="nextHalf()">CONTINUAR</button>
</div>

<div id="ui-container">
<div class="hud-box" id="score">ðŸ”´ 0 - 0 ðŸ”µ</div>
<div class="hud-box" id="timer">03:00</div>
</div>

<div id="goalMsg">Â¡GOOOOOL!</div>
<div id="game"></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.157.0/build/three.min.js"></script>
<script>
let gameActive=false,timeLeft=180,currentHalf=1,redScore=0,blueScore=0,clockInterval,difficultyLevel=0.15;
const scoreEl=document.getElementById('score'),timerEl=document.getElementById('timer'),goalMsg=document.getElementById('goalMsg');

function startGame(d){difficultyLevel=d;menu.style.display='none';game.style.display='block';initGame();startClock();}
function startClock(){gameActive=true;clockInterval=setInterval(()=>{if(!gameActive)return;timeLeft--;timerEl.textContent=`${String(Math.floor(timeLeft/60)).padStart(2,'0')}:${String(timeLeft%60).padStart(2,'0')}`;if(timeLeft<=0)endHalf();},1000);}
function endHalf(){gameActive=false;clearInterval(clockInterval);overlay.style.display='flex';overlayTitle.textContent=currentHalf===1?"DESCANSO":redScore>blueScore?"VICTORIA ðŸ”´":blueScore>redScore?"DERROTA ðŸ”µ":"EMPATE";overlayBtn.onclick=currentHalf===1?nextHalf:()=>location.reload();}
function nextHalf(){currentHalf=2;timeLeft=180;overlay.style.display='none';startClock();}

function initGame(){
const scene=new THREE.Scene();
scene.fog=new THREE.Fog(0x111122,20,150);
const camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,1000);
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
game.appendChild(renderer.domElement);

scene.add(new THREE.HemisphereLight(0xffffff,0x000000,0.7));
const sun=new THREE.DirectionalLight(0xffffff,1);sun.position.set(50,50,20);scene.add(sun);

const W=140,H=80;
const field=new THREE.Mesh(new THREE.PlaneGeometry(W,H),new THREE.MeshPhongMaterial({color:0x2f8f2f}));
field.rotation.x=-Math.PI/2;scene.add(field);

function createGoal(x){
const g=new THREE.Group(),m=new THREE.MeshStandardMaterial({color:0xffffff});
[[0,3.5,-8],[0,3.5,8]].forEach(p=>{const post=new THREE.Mesh(new THREE.BoxGeometry(0.5,7,0.5),m);post.position.set(...p);g.add(post);});
const bar=new THREE.Mesh(new THREE.BoxGeometry(0.5,0.5,16.5),m);bar.position.set(0,7,0);g.add(bar);
g.position.x=x;scene.add(g);
}
createGoal(-W/2);createGoal(W/2);

/* =======================
   MODELO HUMANOIDE PRO
   ======================= */
function createPlayer(color,x,z,isGoalie=false){
const g=new THREE.Group();
const kit=new THREE.MeshStandardMaterial({color});
const skin=new THREE.MeshStandardMaterial({color:0xffdbac});
const dark=new THREE.MeshStandardMaterial({color:0x222});

/* PIERNAS */
function leg(offset){
const pivot=new THREE.Group();pivot.position.set(offset,1.1,0);
const thigh=new THREE.Mesh(new THREE.BoxGeometry(0.35,0.8,0.35),kit);thigh.position.y=-0.4;
const calf=new THREE.Mesh(new THREE.BoxGeometry(0.32,0.8,0.32),kit);calf.position.y=-1.2;
const foot=new THREE.Mesh(new THREE.BoxGeometry(0.5,0.2,0.8),dark);foot.position.set(0,-1.7,0.25);
pivot.add(thigh,calf,foot);g.add(pivot);return pivot;
}
const LLegP=leg(-0.3),RLegP=leg(0.3);

/* TORSO + HOMBROS */
const torso=new THREE.Mesh(new THREE.BoxGeometry(1,1.4,0.6),kit);torso.position.y=2.2;g.add(torso);

/* BRAZOS */
function arm(offset){
const pivot=new THREE.Group();pivot.position.set(offset,2.8,0);
const upper=new THREE.Mesh(new THREE.BoxGeometry(0.3,0.7,0.3),skin);upper.position.y=-0.35;
const lower=new THREE.Mesh(new THREE.BoxGeometry(0.28,0.7,0.28),skin);lower.position.y=-1.0;
pivot.add(upper,lower);g.add(pivot);return pivot;
}
const LArmP=arm(-0.75),RArmP=arm(0.75);

/* CUELLO + CABEZA */
const neck=new THREE.Mesh(new THREE.CylinderGeometry(0.18,0.18,0.3,8),skin);neck.position.y=3.2;g.add(neck);
const head=new THREE.Mesh(new THREE.SphereGeometry(0.45,16,16),skin);head.position.y=3.7;g.add(head);
const hair=new THREE.Mesh(new THREE.SphereGeometry(0.47,16,16),dark);hair.scale.y=0.7;hair.position.y=3.85;g.add(hair);

g.position.set(x,0,z);scene.add(g);
g.userData={color,homeX:x,homeZ:z,isGoalie,speed:difficultyLevel,anim:0};
g.parts={LLegP,RLegP,LArmP,RArmP,torso};
return g;
}

/* ===== 11 VS 11 TEAMS ===== */
const redTeam=[],blueTeam=[];
[[-68,0,true],[-60,20],[-60,-20],[-50,0],[-40,25],[-40,-25],[-30,15],[-30,-15],[-20,30],[-20,0],[-20,-30]].forEach(p=>{
redTeam.push(createPlayer(0xff3333,p[0],p[1],p[2]));
blueTeam.push(createPlayer(0x3333ff,-p[0],p[1],p[2]));
});
const user=redTeam[10];

const ball=new THREE.Mesh(new THREE.SphereGeometry(0.5,16,16),new THREE.MeshStandardMaterial({color:0xffffff}));
ball.position.y=0.5;ball.userData={vx:0,vz:0,holder:null};scene.add(ball);

const keys={};
onkeydown=e=>keys[e.key.toLowerCase()]=true;
onkeyup=e=>keys[e.key.toLowerCase()]=false;

function animateHumanoid(p,m){
if(m){
p.userData.anim+=0.15;
const s=Math.sin(p.userData.anim)*0.6;
p.parts.LLegP.rotation.x=s;
p.parts.RLegP.rotation.x=-s;
p.parts.LArmP.rotation.x=-s*0.7;
p.parts.RArmP.rotation.x=s*0.7;
}
}

function dist2D(a,b){
return Math.sqrt((a.x-b.position.x)**2+(a.z-b.position.z)**2);
}

function checkBallPickup(){
if(!ball.userData.holder&&dist2D(ball.position,user)<2){
ball.userData.holder=user;
}
}

function checkGoal(){
if(Math.abs(ball.position.z)<8&&ball.position.y<7){
if(ball.position.x<-W/2+1){
blueScore++;
showGoal();
resetBall();
}else if(ball.position.x>W/2-1){
redScore++;
showGoal();
resetBall();
}
}
scoreEl.textContent=`ðŸ”´ ${redScore} - ${blueScore} ðŸ”µ`;
}

function showGoal(){
goalMsg.style.display='block';
setTimeout(()=>goalMsg.style.display='none',2000);
}

function resetBall(){
ball.position.set(0,0.5,0);
ball.userData.vx=0;
ball.userData.vz=0;
ball.userData.holder=null;
}

function animate(){
requestAnimationFrame(animate);
let moving=false;

if(keys.w||keys.arrowup){
user.position.x+=Math.sin(user.rotation.y)*0.35;
user.position.z+=Math.cos(user.rotation.y)*0.35;
moving=true;
}
if(keys.s||keys.arrowdown){
user.position.x-=Math.sin(user.rotation.y)*0.2;
user.position.z-=Math.cos(user.rotation.y)*0.2;
moving=true;
}
if(keys.a||keys.arrowleft)user.rotation.y+=0.08;
if(keys.d||keys.arrowright)user.rotation.y-=0.08;

animateHumanoid(user,moving);
checkBallPickup();

// Ball logic
if(ball.userData.holder){
ball.position.x=ball.userData.holder.position.x+Math.sin(ball.userData.holder.rotation.y)*1.5;
ball.position.z=ball.userData.holder.position.z+Math.cos(ball.userData.holder.rotation.y)*1.5;
ball.position.y=0.5;
}else{
ball.position.x+=ball.userData.vx;
ball.position.z+=ball.userData.vz;
ball.userData.vx*=0.95;
ball.userData.vz*=0.95;
if(Math.abs(ball.userData.vx)<0.01)ball.userData.vx=0;
if(Math.abs(ball.userData.vz)<0.01)ball.userData.vz=0;
}

// Shoot
if(keys.e&&ball.userData.holder===user){
ball.userData.holder=null;
ball.userData.vx=Math.sin(user.rotation.y)*1.2;
ball.userData.vz=Math.cos(user.rotation.y)*1.2;
keys.e=false;
}

// Pass
if(keys.q&&ball.userData.holder===user){
ball.userData.holder=null;
ball.userData.vx=Math.sin(user.rotation.y)*0.6;
ball.userData.vz=Math.cos(user.rotation.y)*0.6;
keys.q=false;
}

// Field boundaries
user.position.x=Math.max(-W/2+2,Math.min(W/2-2,user.position.x));
user.position.z=Math.max(-H/2+2,Math.min(H/2-2,user.position.z));

ball.position.x=Math.max(-W/2,Math.min(W/2,ball.position.x));
ball.position.z=Math.max(-H/2,Math.min(H/2,ball.position.z));

checkGoal();

camera.position.lerp(new THREE.Vector3(user.position.x-20*Math.sin(user.rotation.y),18,user.position.z-20*Math.cos(user.rotation.y)),0.1);
camera.lookAt(user.position.x,2,user.position.z);
renderer.render(scene,camera);
}
animate();
}
</script>
</body>
</html>
