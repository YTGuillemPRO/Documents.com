<script>
  // CONFIGURACI√ìN DE DATOS - TUS PETS EXACTOS
  const petsConfig = {
    normal: [
      {icon:'üê≠', name:'Rat√≥n de Campo', rarity:'common', earnings:5},
      {icon:'üê∂', name:'Perro Fiel', rarity:'common', earnings:12},
      {icon:'üê±', name:'Gato Curioso', rarity:'common', earnings:15},
      {icon:'üê∞', name:'Conejo', rarity:'common', earnings:20},
      {icon:'üê•', name:'Pollito', rarity:'common', earnings:25},
      {icon:'ü¶ä', name:'Zorro', rarity:'rare', earnings:80},
      {icon:'üêª', name:'Oso', rarity:'rare', earnings:110},
      {icon:'üêº', name:'Panda', rarity:'rare', earnings:150},
      {icon:'üê®', name:'Koala', rarity:'rare', earnings:200},
      {icon:'üêØ', name:'Tigre', rarity:'epic', earnings:450},
      {icon:'ü¶Å', name:'Le√≥n', rarity:'epic', earnings:600},
      {icon:'üê∫', name:'Lobo', rarity:'epic', earnings:800}
    ],
    special: [
      {icon:'ü¶Å', name:'Le√≥n Majestuoso', rarity:'rare', earnings:200},
      {icon:'ü¶Ñ', name:'Unicornio M√≠stico', rarity:'god', earnings:650},
      {icon:'üê≤', name:'Drag√≥n Ancestral', rarity:'god', earnings:1500},
      {icon:'ü¶ñ', name:'T-Rex OG', rarity:'og', earnings:6000},
      {icon:'ü¶Ñ', name:'Unicornio', rarity:'legendary', earnings:2500},
      {icon:'üê≤', name:'Drag√≥n', rarity:'legendary', earnings:3500},
      {icon:'üî±', name:'Poseid√≥n', rarity:'mythic', earnings:8000},
      {icon:'üî•', name:'F√©nix', rarity:'mythic', earnings:12000},
      {icon:'‚ö°', name:'Zeus', rarity:'mythic', earnings:18000},
      {icon:'üëæ', name:'Glitch', rarity:'secret', earnings:50000},
      {icon:'üåå', name:'Galaxia', rarity:'secret', earnings:100000},
      {icon:'üíé', name:'Diamante', rarity:'secret', earnings:250000},
      {icon:'üëÅÔ∏è', name:'Illuminati', rarity:'secret', earnings:500000},
      {icon:'üëë', name:'EL REY OG', rarity:'og', earnings:2000000}
    ]
  };

  const rebirthCosts = [1000000, 15000000, 100000000, 750000000, 3000000000];
  
  // ESTADO GLOBAL
  let state = {
    money: 10,
    rb: 0,
    mult: 1,
    pets: [],
    discovered: [],
    priceN: 10,
    priceS: 500
  };

  let isSpecial = false;

  // INICIALIZAR AL CARGAR LA P√ÅGINA
  function init() {
    load();
    // Event listeners para todos los botones
    document.getElementById('closeHatchBtn').onclick = closeHatch;
    document.getElementById('buyEggBtn').onclick = openEgg;
    document.getElementById('rebirthBtn').onclick = doRebirth;
    document.getElementById('normalBtn').onclick = () => setEgg(false);
    document.getElementById('specialBtn').onclick = () => setEgg(true);
    document.getElementById('tabPetsBtn').onclick = () => switchTab('pets');
    document.getElementById('tabIndexBtn').onclick = () => switchTab('index');
  }

  // GUARDADO/LOAD
  function save() { 
    localStorage.setItem('PetSimPro_GlobalSave', JSON.stringify(state)); 
  }

  function load() {
    const data = localStorage.getItem('PetSimPro_GlobalSave');
    if (data) {
      state = JSON.parse(data);
    }
    updateUI();
  }

  // ACTUALIZAR INTERFAZ
  function updateUI() {
    document.getElementById('money').innerText = Math.floor(state.money).toLocaleString();
    document.getElementById('rbLevel').innerText = state.rb;
    document.getElementById('rbMult').innerText = state.mult.toFixed(2);
    document.getElementById('priceN').innerText = state.priceN.toLocaleString();
    document.getElementById('priceS').innerText = state.priceS.toLocaleString();
    
    const rbBtn = document.getElementById('rebirthBtn');
    if (state.rb >= 5) {
      rbBtn.innerText = "‚≠ê M√ÅXIMO NIVEL ALCANZADO";
      rbBtn.disabled = true;
    } else {
      let cost = rebirthCosts[state.rb];
      rbBtn.innerText = `‚ö° REBIRTH ${state.rb+1} ($${cost.toLocaleString()})`;
      rbBtn.disabled = state.money < cost;
    }
    renderPets();
  }

  // SELECCIONAR TIPO DE HUEVO
  function setEgg(special) { 
    isSpecial = special; 
    document.getElementById('normalBtn').classList.toggle('active', !special); 
    document.getElementById('specialBtn').classList.toggle('active', special); 
  }

  // ABRIR HUEVO (HATCH FUNCIONA)
  function openEgg() {
    let cost = isSpecial ? state.priceS : state.priceN;
    if (state.money < cost) {
      alert('¬°No tienes suficiente dinero!');
      return;
    }
    
    state.money -= cost;
    if (isSpecial) state.priceS = Math.floor(state.priceS * 1.35);
    else state.priceN = Math.floor(state.priceN * 1.28);

    const pool = isSpecial ? petsConfig.special : petsConfig.normal;
    const pet = pool[Math.floor(Math.random() * pool.length)];
    state.pets.push({...pet, id: Date.now()});
    
    if (!state.discovered.includes(pet.name)) {
      state.discovered.push(pet.name);
    }

    playHatchAnimation(pet);
    save();
    updateUI();
  }

  // ANIMACI√ìN DEL HATCH
  function playHatchAnimation(pet) {
    const overlay = document.getElementById('hatchOverlay');
    const egg = document.getElementById('hatchEgg');
    const icon = document.getElementById('hatchedPetIcon');
    
    overlay.style.display = 'flex';
    egg.style.display = 'block';
    icon.style.display = 'none';
    egg.className = 'shaking';

    setTimeout(() => {
      egg.className = 'breaking';
      setTimeout(() => {
        egg.style.display = 'none';
        icon.style.display = 'block';
        icon.innerText = pet.icon;
        document.getElementById('hatchedPetName').innerText = pet.name;
        document.getElementById('hatchedPetInfo').innerText = `${pet.rarity.toUpperCase()} | +$${(pet.earnings * state.mult).toLocaleString()}/s`;
      }, 600);
    }, 1500);
  }

  // CERRAR HATCH
  function closeHatch() {
    const overlay = document.getElementById('hatchOverlay');
    const egg = document.getElementById('hatchEgg');
    const icon = document.getElementById('hatchedPetIcon');
    overlay.style.display = 'none';
    egg.className = '';
    egg.style.display = 'block';
    icon.style.display = 'none';
  }

  // MOSTRAR MASCOTAS
  function renderPets() {
    const list = document.getElementById('petList');
    list.innerHTML = '';
    state.pets.forEach(p => {
      const div = document.createElement('div');
      div.className = `pet ${p.rarity}`;
      div.innerHTML = `
        <span>${p.icon} ${p.name}</span>
        <span>
          $${(p.earnings * state.mult).toLocaleString()}/s 
          <button class="sellBtn" onclick="sellPet(${p.id})">Vender</button>
        </span>
      `;
      list.appendChild(div);
    });
  }

  // VENDER MASCOTA
  function sellPet(id) {
    let idx = state.pets.findIndex(p => p.id === id);
    if (idx === -1) return;
    state.money += state.pets[idx].earnings * 15;
    state.pets.splice(idx, 1);
    save(); 
    updateUI();
  }

  // REBIRTH
  function doRebirth() {
    if (state.rb >= 5 || state.money < rebirthCosts[state.rb]) return;
    state.rb++;
    state.mult *= 4;
    state.money = 10;
    state.pets = [];
    state.priceN = 10;
    state.priceS = 500;
    save(); 
    updateUI();
    alert("¬°REBIRTH COMPLETADO! Ganancias x4.");
  }

  // CAMBIAR PESTA√ëAS
  function switchTab(tab) {
    document.getElementById('tabPets').style.display = tab === 'pets' ? 'flex' : 'none';
    document.getElementById('tabIndex').style.display = tab === 'index' ? 'block' : 'none';
    document.getElementById('tabPetsBtn').classList.toggle('active', tab === 'pets');
    document.getElementById('tabIndexBtn').classList.toggle('active', tab === 'index');
    if (tab === 'index') renderIndex();
  }

  // INDEX DE MASCOTAS
  function renderIndex() {
    const list = document.getElementById('indexList');
    list.innerHTML = '';
    [...petsConfig.normal, ...petsConfig.special].forEach(p => {
      const discovered = state.discovered.includes(p.name);
      const div = document.createElement('div');
      div.className = `pet ${p.rarity}`;
      div.style.opacity = discovered ? '1' : '0.4';
      div.innerHTML = `<span>${discovered ? p.icon : '‚ùì'} ${p.name}</span><span>${p.rarity.toUpperCase()}</span>`;
      list.appendChild(div);
    });
  }

  // BUCLE PRINCIPAL - GANANCIAS POR SEGUNDO
  setInterval(() => {
    let income = state.pets.reduce((total, pet) => total + pet.earnings, 0) * state.mult;
    if (income > 0) {
      state.money += income;
      updateUI();
    }
  }, 1000);

  // INICIAR CUANDO CARGA LA P√ÅGINA
  window.addEventListener('load', init);
</script>
