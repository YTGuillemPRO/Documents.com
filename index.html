<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Juegos - Home</title>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background-color: #f6f8fa; }
    
    /* Barra de Navegaci√≥n / Auth */
    #auth-container { 
      background: #24292e; 
      color: white; 
      padding: 10px 20px; 
      display: flex; 
      justify-content: space-between; 
      align-items: center;
      min-height: 50px;
    }

    /* Formulario de login cuando no est√° conectado */
    .login-form { display: flex; gap: 10px; align-items: center; }
    .login-form input { padding: 5px; border-radius: 4px; border: none; }
    
    /* Botones */
    .btn { padding: 6px 12px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; transition: 0.3s; }
    .btn-green { background-color: #2ea44f; color: white; }
    .btn-green:hover { background-color: #2c974b; }
    .btn-github { background-color: #444; color: white; }

    /* Men√∫ de los tres puntos */
    .menu-container { position: relative; display: inline-block; }
    .dots-btn { 
      background: none; 
      border: none; 
      color: white; 
      font-size: 24px; 
      cursor: pointer; 
      padding: 0 10px; 
      line-height: 1;
    }
    .dropdown-content {
      display: none;
      position: absolute;
      right: 0;
      background-color: white;
      min-width: 160px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1;
      border-radius: 4px;
      overflow: hidden;
    }
    .dropdown-content button {
      color: #333;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
      width: 100%;
      border: none;
      background: none;
      text-align: left;
      cursor: pointer;
    }
    .dropdown-content button:hover { background-color: #f1f1f1; }
    .show { display: block !important; }

    .hidden { display: none !important; }
    section { padding: 20px; border-bottom: 1px solid #ddd; background: white; margin: 10px 20px; border-radius: 8px; }
    a { text-decoration: none; color: #0366d6; font-size: 1.2rem; font-weight: bold; }
  </style>
</head>
<body>

  <div id="auth-container">
    <div id="brand"><strong>Mis Juegos 2026</strong></div>

    <div id="user-logged-out" class="login-form">
      <input type="email" id="email" placeholder="Correo">
      <input type="password" id="password" placeholder="Contrase√±a">
      <button id="btn-login-email" class="btn btn-green">Entrar</button>
      <button id="btn-login-github" class="btn btn-github">GitHub</button>
    </div>

    <div id="user-logged-in" class="hidden">
      <span id="welcome-msg"></span>
      <div class="menu-container">
        <button id="dots-menu" class="dots-btn">‚ãÆ</button>
        <div id="myDropdown" class="dropdown-content">
          <button id="btn-change-account">üîÑ Cambiar de cuenta</button>
          <button id="btn-logout" style="color: red;">‚ùå Cerrar Sesi√≥n</button>
        </div>
      </div>
    </div>
  </div>

  <div id="game-list">
    <section><a href="juego1/index.html">Pets and Money</a></section>
    <section><a href="juego2/index.html">No cliques el Bot√≥n</a></section>
    <section><a href="juego3/index.html">Steal a Brainrot</a></section>
    <section><a href="juego4/index.html">FiFa</a></section>
    <section><a href="juego5/index.html">TikTok</a></section>
    <section><a href="juego6/index.html">Clash Royale</a></section>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { 
      getAuth, signInWithPopup, GithubAuthProvider, onAuthStateChanged, signOut, 
      signInWithEmailAndPassword 
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDpmb0duQ3ZgjbipPWsMvpLx3d-vojQAxM",
      authDomain: "inici-de-sessio.firebaseapp.com",
      projectId: "inici-de-sessio",
      storageBucket: "inici-de-sessio.firebasestorage.app",
      messagingSenderId: "106046428749",
      appId: "1:106046428749:web:c555c61ff94f5f5691ee04"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GithubAuthProvider();

    // Elementos UI
    const dotsBtn = document.getElementById('dots-menu');
    const dropdown = document.getElementById('myDropdown');
    const emailInput = document.getElementById('email');
    const passInput = document.getElementById('password');

    // --- MANEJO DEL MEN√ö ---
    dotsBtn.onclick = (e) => {
      e.stopPropagation();
      dropdown.classList.toggle("show");
    };

    // Cerrar men√∫ si se hace clic fuera
    window.onclick = () => {
      if (dropdown.classList.contains('show')) dropdown.classList.remove('show');
    };

    // --- ACCIONES DE CUENTA ---
    document.getElementById('btn-login-email').onclick = () => {
      signInWithEmailAndPassword(auth, emailInput.value, passInput.value)
        .catch(err => alert("Error: Datos incorrectos"));
    };

    document.getElementById('btn-login-github').onclick = () => {
      signInWithPopup(auth, provider);
    };

    // Tanto "Cerrar sesi√≥n" como "Cambiar cuenta" hacen signOut
    const closeSession = () => signOut(auth);
    document.getElementById('btn-logout').onclick = closeSession;
    document.getElementById('btn-change-account').onclick = closeSession;

    // --- OBSERVADOR ---
    onAuthStateChanged(auth, (user) => {
      if (user) {
        document.getElementById('user-logged-out').classList.add('hidden');
        document.getElementById('user-logged-in').classList.remove('hidden');
        document.getElementById('welcome-msg').innerText = user.displayName || user.email;
      } else {
        document.getElementById('user-logged-out').classList.remove('hidden');
        document.getElementById('user-logged-in').classList.add('hidden');
      }
    });

    // Aviso legal
    window.onload = () => {
      setTimeout(() => {
        if (!confirm("‚ö†Ô∏è AVISO ‚ö†Ô∏è\n\n¬øAceptas los riesgos de jugar en este entorno?")) 
          window.location.href = "https://www.google.com";
      }, 500);
    };
  </script>
</body>
</html>
